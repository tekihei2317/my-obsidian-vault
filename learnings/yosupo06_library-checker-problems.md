# yosupo06_library-checker-problems

リンク: 

Library Checker（通称yosupo judge）のソースコード。

問題を追加するためには以下のファイルを作成する必要があるようです。

```text
フォルダの作成
info.toml
task.md(問題文)
sol/correct.cpp(想定解)
verifier.cpp(input checker)
checker.cpp(output checker)
gen/example_00.in, gen/example_01.in, gen/random.cppなど(テストケースジェネレーター)
```

問題文のマークダウンは、テストケースや設定値の埋め込みができるように拡張されているようです。

ジェネレーターを実行すると、テストケース生成、入力チェック、回答の実行、出力チェックが実行されます。テストケース（入出力の情報）が、`hash.json`に登録されます。これはデプロイのときに使用されている気がします。

```json
{
  "example_00.in": "e0518cbffe61b792644f3d8a4a335904f5a6d1f2d64c9f37e0f03b852df40062",
  "example_00.out": "e4749bc7f4f9360cf6a2e56321b815c8de72808a8ee756a48722cc9b287ddc24",
  "path_00.in": "412432d3c296d117a7f6c36766feeab06d57f9532c6a40a799a1f8e2df9a1121",
  "path_00.out": "38618589fee0128f74fcc3e242b162f177bc49987ed94a89fa7daf2f2a950034",
  "path_01.in": "2c476bd0b8ccc48dbb2ccf5619c8b36760d485f5f12817cdf5db3c9625df2a69",
  "path_01.out": "38618589fee0128f74fcc3e242b162f177bc49987ed94a89fa7daf2f2a950034",
}
```

## デプロイ周りを見てみる

以下の点が気になっています。

- 問題のデータをどう保持しているか（ソースコード、アプリケーション）
	- ソースコード
		- 問題文はmarkdownに書き、問題情報はtomlファイルに書きます
	- アプリケーション
		- 問題やテストケースの情報はDBに保存していないような気がします
		- CIでファイル生成→ファイルを送信→テストではファイルを使用という感じ？
- テストケースのデータをどう保持しているか（ソースコード、アプリケーション）
	- ソースコード
		- 入出力ファイルはgitignoreに含まれています
		- ハッシュをもとに一致しているか確認しているようです
	- アプリケーション
- 問題が追加されたときにどうデプロイしているか
- テストケースが追加さあれたときにどうデプロイしているか

## CIを見てみる

`ci_generate.py`を実行しています。

`ci_generate.py`は、問題のバージョンを保持していて、変更があった問題についてだけ実行されるようになっています。何をしているのかはまだわかっていません。

問題文のHTMLは、ここで生成している気がします。フロントエンドのリポジトリも見てみると分かりそうです。

`generate_test.py`も実行しています。

`library-checker-judge`のほうの`problems_deploy.py`を実行しています。

このスクリプトでは、HTMLなどを生成してから、問題を更新するリクエストをAPIに送信しています。

まだ全然理解できていないので、フロントエンドとAPIも見てみたいです。API側のデータベースのproblemsテーブルにsource_urlがあり、これにGitHubのURLが入るみたいなので、テストケースはここからダウンロードして作成しているような気がします。
